<!-- /*
QuickNotes React — Single-file (CDN) — ready to copy-paste into your project

WHAT THIS FILE IS
- A complete `index.html` that uses React (via CDN) + Tailwind (via CDN) + Babel.
- It renders a simple, nicer QuickNotes app (title + content), saves to Supabase REST API, and lists saved notes.
- It expects your existing `config.js` (in the same folder) to define these global constants:
    const SUPABASE_URL = 'https://...supabase.co';
    const SUPABASE_ANON_KEY = '...anon-key...';
  (You already made this before. Keep config.js in the folder; it is ignored by git.)

HOW TO USE (baby steps)
1) Backup: rename your current index.html to index.html.bak (just in case).
2) Create a new file named `index.html` (or overwrite the old one) and paste the ENTIRE content below into it.
3) Make sure `config.js` exists in the same folder (with your Supabase keys).
4) Open `index.html` in your browser (double click) or upload to Netlify to deploy.
5) Test: add a note, then check Supabase Table Editor -> notes to see the row.

IF SOMETHING FAILS
- If page shows message about missing config: make sure config.js exists and has correct keys.
- If Save shows network or 401/403: check Supabase policies (run the SQL we gave earlier) and the anon key.
- If Tailwind styling looks different: ensure internet is available (CDN loads).

Once this works, we'll make one small UI improvement at a time (animations, edit/delete, auth, etc.).
*/ -->

<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>QuickNotes — React (CDN)</title>
    <!-- Tailwind CDN (quick and easy) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React + ReactDOM (development builds, fine for local/demo) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel to compile JSX in browser (only for development / learning) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      /* small fallback styles in case Tailwind takes time */
      body { font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }
    
      /*keyframes for fadeIn animation*/
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fadeIn {
            animation: fadeIn 0.5s ease-in-out;
        }

    </style>
  </head>
  <body class="min-h-screen bg-gradient-to-r from-blue-50 via-purple-50 to-pink-50"></body>
    <!-- Your config.js (global constants) should be loaded BEFORE the React app -->
    <script src="config.js"></script>

    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // SAFETY: the page expects global constants SUPABASE_URL and SUPABASE_ANON_KEY from config.js
      if (typeof SUPABASE_URL === 'undefined' || typeof SUPABASE_ANON_KEY === 'undefined') {
        const el = document.createElement('div');
        el.style.padding = '20px';
        el.style.color = 'red';
        el.textContent = 'Missing config.js with SUPABASE_URL and SUPABASE_ANON_KEY. Create config.js and reload.';
        document.body.prepend(el);
        throw new Error('Missing Supabase config');
      }

      function QuickNotesApp() {
        const [title, setTitle] = useState('');
        const [content, setContent] = useState('');
        const [notes, setNotes] = useState([]);
        const [loading, setLoading] = useState(false);
        const [saving, setSaving] = useState(false);
        const [error, setError] = useState('');
        const [deletingId, setDeletingId] = useState(null);

        const API_URL = SUPABASE_URL + '/rest/v1/notes';

        useEffect(() => { loadNotes(); }, []);

        async function loadNotes() {
          setLoading(true); setError('');
          try {
            const res = await fetch(API_URL + '?select=*&order=created_at.desc', {
              headers: {
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
              }
            });
            if (!res.ok) throw new Error('Fetch failed');
            const data = await res.json();
            setNotes(data || []);
          } catch (err) {
            console.error(err);
            setError('Could not load notes. Check console.');
          }
          setLoading(false);
        }

        async function saveNote(e) {
          e && e.preventDefault();
          setError('');
          if (!title.trim() || !content.trim()) { setError('Please add title and content'); return; }
          setSaving(true);
          try {
            const body = [{ title: title.trim(), content: content.trim() }];
            const res = await fetch(API_URL, {
              method: 'POST',
              headers: {
                'apikey': SUPABASE_ANON_KEY,
                'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                'Content-Type': 'application/json',
                'Prefer': 'return=representation'
              },
              body: JSON.stringify(body)
            });
            if (!res.ok) {
              const txt = await res.text();
              console.error('Save failed', res.status, txt);
              throw new Error('Save failed');
            }
            await res.json();
            setTitle(''); setContent('');
            await loadNotes();
          } catch (err) {
            console.error(err);
            setError('Error saving note (see console)');
          }
          setSaving(false);
        }

        return (
          <div className="min-h-screen flex items-center justify-center p-6 relative">
    
            <header className="absolute top-0 w-full bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 text-white py-4 shadow-md">
                <h1 className="text-center text-3xl font-extrabold tracking-wide animate-pulse">
                    QuickNotes
                </h1>
            </header>
            
            <div className="w-full max-w-2xl bg-white p-6 rounded-xl shadow-lg mt-20">
              <div className="flex items-start justify-between">
                <h1 className="text-2xl font-semibold">QuickNotes — React</h1>
                <div className="text-sm text-gray-500">Local demo</div>
              </div>

              <form onSubmit={saveNote} className="mt-4 space-y-3">
                <input
                  value={title}
                  onChange={e => setTitle(e.target.value)}
                  placeholder="Title"
                  className="w-full border p-3 rounded focus:outline-none focus:ring-2 focus:ring-blue-300"
                />
                <textarea
                    value={content}
                        onChange={e => {
                            setContent(e.target.value);
                            e.target.style.height = "auto";   // reset height
                            e.target.style.height = e.target.scrollHeight + "px"; // grow with content
                        }}
                    placeholder="Write your note here..."
                    className="border rounded-xl p-3 w-full resize-none overflow-hidden transition-all duration-200 focus:ring-2 focus:ring-purple-400 focus:outline-none"
                    required
                />

                <div className="flex items-center gap-3">
                  <button type="submit"
                    className="relative overflow-hidden px-6 py-2 rounded-xl bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500 text-white font-semibold shadow-md transition-all duration-300 hover:scale-105 hover:shadow-xl active:scale-95">
                        <span className="relative z-10"> Save</span>
                            <span className="absolute inset-0 bg-white opacity-0 transition duration-500 ease-out hover:opacity-20"></span>
                  </button>
                  <button type="button" onClick={() => { setTitle(''); setContent(''); setError(''); }} className="px-3 py-2 border rounded">
                    Clear
                  </button>

                  <div className="ml-auto text-sm text-red-600">{error}</div>
                </div>
              </form>

              <hr className="my-5" />

              <h2 className="text-lg font-medium mb-3">Saved Notes</h2>

              {loading ? (
                <div className="text-gray-500">Loading notes...</div>
              ) : (
                <div>
                  {notes.length === 0 ? (
                    <div className="text-sm text-gray-500">No notes yet — add your first one.</div>
                  ) : (

                  
                    <ul className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 justify-center">
                        {notes.map(n => (
                            <li
                            key={n.id}
                            className="p-4 border rounded-2xl shadow-sm transform transition-all duration-300 hover:shadow-lg hover:scale-[1.02] animate-fadeIn flex flex-col justify-between"
                            style={{
                                backgroundColor: ["#F2F1ED", "#F2F1ED", "#CDE5D9", "#BBDEFB", "#F0E2C3"][n.id % 5],
                                width: '185px',
                                height: '140px'
                            }}
                            >
                            <div className="overflow-hidden">
                                <div className="font-semibold text-lg text-gray-800">{n.title}</div>
                                <div className="text-gray-700 mt-2 whitespace-pre-wrap overflow-hidden">{n.content}</div>
                            </div>

                            <div className="flex items-center justify-between mt-3">
                                <div className="text-xs text-gray-400">
                                {n.created_at ? new Date(n.created_at).toLocaleString() : ''}
                                </div>

                                <button
                                onClick={async () => {
                                    if (!confirm("Delete this note?")) return;
                                    try {
                                    setDeletingId(n.id);
                                    const res = await fetch(API_URL + `?id=eq.${n.id}`, {
                                        method: "DELETE",
                                        headers: {
                                        "apikey": SUPABASE_ANON_KEY,
                                        "Authorization": `Bearer ${SUPABASE_ANON_KEY}`
                                        }
                                    });
                                    if (!res.ok) {
                                        const txt = await res.text();
                                        console.error("Delete failed", res.status, txt);
                                        throw new Error("Delete failed");
                                    }
                                    await loadNotes();
                                    } catch (err) {
                                    console.error("Delete failed", err);
                                    setError("Error deleting note");
                                    } finally {
                                    setDeletingId(null);
                                    }
                                }}
                                disabled={deletingId === n.id}
                                className="text-xs text-red-600 hover:text-red-800 transition disabled:opacity-50"
                                >
                                {deletingId === n.id ? "Deleting..." : "Delete"}
                                </button>
                            </div>
                            </li>
                        ))}
                    </ul>


                  )}
                </div>
              )}
            </div>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById('root')).render(<QuickNotesApp />);
    </script>
  </body>
</html>
